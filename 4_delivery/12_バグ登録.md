---
name: ãƒã‚°ç™»éŒ²ï¼ˆQAä¸­ã®ãƒã‚°ãƒ»æ”¹å–„ç‚¹ç™»éŒ²ï¼‰
---

# 12 : ãƒã‚°ç™»éŒ² - QAå®Ÿè¡Œä¸­ã®ãƒã‚°ãƒ»æ”¹å–„ç‚¹ã‚’ä½“ç³»çš„ã«è¨˜éŒ²

## å‰æ
- QAå®Ÿè¡Œï¼ˆ11_QAå®Ÿè¡Œï¼‰ãŒå®Ÿæ–½ä¸­ã¾ãŸã¯å®Œäº†æ¸ˆã¿
- bug_tracking/bugs.yaml ãŒå­˜åœ¨
- çµ±åˆãƒ†ã‚¹ãƒˆãƒ»ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­ã«ãƒã‚°ãƒ»æ”¹å–„ç‚¹ã‚’ç™ºè¦‹

## ç›®çš„
- QAå®Ÿè¡Œä¸­ã«ç™ºè¦‹ã—ãŸãƒã‚°ãƒ»æ”¹å–„ç‚¹ã‚’å³åº§ã«è¨˜éŒ²
- å†ç¾æ‰‹é †ãƒ»ç’°å¢ƒæƒ…å ±ã‚’å«ã‚€è©³ç´°ãªãƒã‚°ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ
- bugs.yamlã¸ã®è‡ªå‹•è¿½è¨˜ã¨å€‹åˆ¥ãƒ¬ãƒãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ
- ãƒã‚°IDè‡ªå‹•æ¡ç•ªï¼ˆBUG-XXX, IMP-XXX, TF-XXXï¼‰

## å®Ÿè¡Œæ‰‹é †
```yaml
- trigger: "(ãƒã‚°ç™»éŒ²|Bug Report|æ”¹å–„ç™»éŒ²|ãƒ†ã‚¹ãƒˆå¤±æ•—ç™»éŒ²)"
  priority: high
  steps:
    # ========================================
    # Phase 1: ãƒã‚°æƒ…å ±åé›†
    # ========================================
    - name: "collect_bug_info"
      action: "ask_questions"
      questions:
        - key: "bug_type"
          question: |
            ãƒã‚°ã®ã‚¿ã‚¤ãƒ—ã‚’é¸æŠã—ã¦ãã ã•ã„:
            1) bug - å®Ÿè£…ã®ä¸å…·åˆ
            2) improvement - æ”¹å–„ææ¡ˆ
            3) test_failure - ãƒ†ã‚¹ãƒˆå¤±æ•—
          options: ["bug", "improvement", "test_failure"]
          required: true
        
        - key: "title"
          question: "ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆ1è¡Œè¦ç´„ï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:"
          required: true
        
        - key: "severity"
          question: |
            æ·±åˆ»åº¦ã‚’é¸æŠã—ã¦ãã ã•ã„:
            1) critical - ã‚·ã‚¹ãƒ†ãƒ åœæ­¢ã€ãƒ‡ãƒ¼ã‚¿æå¤±
            2) high - ä¸»è¦æ©Ÿèƒ½ãŒä½¿ç”¨ä¸å¯
            3) medium - æ©Ÿèƒ½ã®ä¸€éƒ¨ãŒå‹•ä½œã—ãªã„
            4) low - è»½å¾®ãªå•é¡Œã€å›é¿ç­–ã‚ã‚Š
          options: ["critical", "high", "medium", "low"]
          required: true
        
        - key: "priority"
          question: |
            å„ªå…ˆåº¦ã‚’é¸æŠã—ã¦ãã ã•ã„:
            1) P0 - å³åº§ã«ä¿®æ­£ï¼ˆãƒ–ãƒ­ãƒƒã‚«ãƒ¼ï¼‰
            2) P1 - æ¬¡ãƒªãƒªãƒ¼ã‚¹ã¾ã§ã«ä¿®æ­£
            3) P2 - ä¿®æ­£æ¨å¥¨
            4) P3 - å°†æ¥å¯¾å¿œ
          options: ["P0", "P1", "P2", "P3"]
          required: true
        
        - key: "found_in_test"
          question: "ç™ºè¦‹ã—ãŸãƒ†ã‚¹ãƒˆåã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆä¾‹: scenario1_new_projectï¼‰:"
          required: true
        
        - key: "description"
          question: "è©³ç´°èª¬æ˜ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:"
          required: true
          multiline: true
        
        - key: "reproduction_steps"
          question: |
            å†ç¾æ‰‹é †ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆ1è¡Œãšã¤ã€ç©ºè¡Œã§çµ‚äº†ï¼‰:
            ä¾‹ï¼‰
            1. ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
            2. nit init ã‚’å®Ÿè¡Œ
            3. nit push ã‚’å®Ÿè¡Œ
          required: false
          multiline: true
        
        - key: "expected_behavior"
          question: "æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:"
          required: false
        
        - key: "actual_behavior"
          question: "å®Ÿéš›ã®å‹•ä½œã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:"
          required: false
        
        - key: "error_log"
          question: "ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ãŒã‚ã‚Œã°è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ï¼ˆç©ºæ¬„å¯ï¼‰:"
          required: false
          multiline: true
      
      store_as: "bug_info"
    
    # ========================================
    # Phase 2: ãƒã‚°IDè‡ªå‹•ç”Ÿæˆ
    # ========================================
    - name: "generate_bug_id"
      action: "execute_python"
      script: |
        import yaml
        from pathlib import Path
        
        bugs_yaml = Path("Stock/programs/Tools/projects/cursor_to_notion/documents/11_QAå®Ÿè¡Œ/bug_tracking/bugs.yaml")
        
        # ãƒã‚°ã‚¿ã‚¤ãƒ—ã‹ã‚‰ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹æ±ºå®š
        type_prefix = {
            "bug": "BUG",
            "improvement": "IMP",
            "test_failure": "TF"
        }
        prefix = type_prefix.get("{{bug_info.bug_type}}", "BUG")
        
        # æ—¢å­˜ãƒã‚°IDã‹ã‚‰æ¬¡ã®IDã‚’ç”Ÿæˆ
        try:
            with open(bugs_yaml, 'r') as f:
                data = yaml.safe_load(f)
            
            existing_ids = [
                b['id'] for b in data.get('bugs', []) 
                if b['id'].startswith(prefix)
            ]
            
            if existing_ids:
                last_num = max(int(bid.split('-')[1]) for bid in existing_ids)
                next_num = last_num + 1
            else:
                next_num = 1
            
            bug_id = f"{prefix}-{next_num:03d}"
        except:
            bug_id = f"{prefix}-001"
        
        print(f"ç”Ÿæˆã•ã‚ŒãŸãƒã‚°ID: {bug_id}")
      
      store_as: "bug_id"
    
    # ========================================
    # Phase 3: bugs.yamlã«è¿½è¨˜
    # ========================================
    - name: "append_to_bugs_yaml"
      action: "execute_python"
      script: |
        import yaml
        from datetime import datetime
        from pathlib import Path
        import os
        
        bugs_yaml = Path("Stock/programs/Tools/projects/cursor_to_notion/documents/11_QAå®Ÿè¡Œ/bug_tracking/bugs.yaml")
        
        # æ—¢å­˜ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
        with open(bugs_yaml, 'r') as f:
            data = yaml.safe_load(f)
        
        # å†ç¾æ‰‹é †ã‚’é…åˆ—ã«å¤‰æ›
        repro_steps = []
        if "{{bug_info.reproduction_steps}}":
            steps_text = "{{bug_info.reproduction_steps}}"
            repro_steps = [line.strip() for line in steps_text.split('\n') if line.strip()]
        
        # æ–°ã—ã„ãƒã‚°ã‚¨ãƒ³ãƒˆãƒªä½œæˆ
        new_bug = {
            'id': "{{bug_id}}",
            'type': "{{bug_info.bug_type}}",
            'severity': "{{bug_info.severity}}",
            'priority': "{{bug_info.priority}}",
            'status': 'new',
            'title': "{{bug_info.title}}",
            'found_by': os.getenv('USER', 'QA Engineer'),
            'found_date': datetime.now().strftime('%Y-%m-%d'),
            'found_in_test': "{{bug_info.found_in_test}}",
            'found_in_phase': 'integration_test',
            'description': "{{bug_info.description}}",
            'reproduction_steps': repro_steps,
            'expected_behavior': "{{bug_info.expected_behavior}}",
            'actual_behavior': "{{bug_info.actual_behavior}}",
            'environment': {
                'os': os.uname().sysname + ' ' + os.uname().release,
                'python_version': '',
                'nit_version': 'v1.0-dev'
            },
            'affected_components': [],
            'affected_scenarios': [],
            'assignee': '',
            'fix_version': '',
            'fix_commit': '',
            'fix_date': '',
            'comments': [],
            'attachments': []
        }
        
        # ãƒã‚°ãƒªã‚¹ãƒˆã«è¿½åŠ 
        if 'bugs' not in data:
            data['bugs'] = []
        data['bugs'].append(new_bug)
        
        # ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æ›´æ–°
        data['metadata']['total_bugs'] = len(data['bugs'])
        data['metadata']['open_bugs'] = sum(
            1 for b in data['bugs'] 
            if b['status'] in ['new', 'open', 'in_progress']
        )
        data['metadata']['last_updated'] = datetime.now().isoformat()
        
        # ä¿å­˜
        with open(bugs_yaml, 'w') as f:
            yaml.dump(data, f, allow_unicode=True, default_flow_style=False, sort_keys=False)
        
        print(f"âœ… bugs.yamlã« {new_bug['id']} ã‚’è¿½åŠ ã—ã¾ã—ãŸ")
    
    # ========================================
    # Phase 4: å€‹åˆ¥ãƒã‚°ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ
    # ========================================
    - name: "create_bug_report_file"
      action: "create_markdown_file"
      path: "Stock/programs/Tools/projects/cursor_to_notion/documents/11_QAå®Ÿè¡Œ/bug_tracking/bug_reports/{{bug_id}}.md"
      content: |
        # {{bug_id}}: {{bug_info.title}}
        
        **ã‚¿ã‚¤ãƒ—**: {{bug_info.bug_type}}  
        **æ·±åˆ»åº¦**: {{bug_info.severity}}  
        **å„ªå…ˆåº¦**: {{bug_info.priority}}  
        **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: new  
        **ç™ºè¦‹æ—¥**: {{today}}  
        **ç™ºè¦‹ãƒ†ã‚¹ãƒˆ**: {{bug_info.found_in_test}}  
        **ç™ºè¦‹è€…**: QA Engineer
        
        ---
        
        ## ğŸ“ èª¬æ˜
        
        {{bug_info.description}}
        
        ---
        
        ## ğŸ”„ å†ç¾æ‰‹é †
        
        {{bug_info.reproduction_steps}}
        
        ---
        
        ## âœ… æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ
        
        {{bug_info.expected_behavior}}
        
        ---
        
        ## âŒ å®Ÿéš›ã®å‹•ä½œ
        
        {{bug_info.actual_behavior}}
        
        ---
        
        ## ğŸ’» ç’°å¢ƒæƒ…å ±
        
        - **OS**: macOS
        - **Python**: 3.13.3
        - **nit Version**: v1.0-dev
        
        ---
        
        ## ğŸ“‹ ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°
        
        ```
        {{bug_info.error_log}}
        ```
        
        ---
        
        ## ğŸ“· ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
        
        ï¼ˆæ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’attachments/screenshots/ã«ä¿å­˜ã—ã¦å‚ç…§ï¼‰
        
        ---
        
        ## ğŸ’¬ èª¿æŸ»ãƒ¡ãƒ¢
        
        <!-- èª¿æŸ»ãƒ»ä¿®æ­£éç¨‹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’ã“ã“ã«è¿½è¨˜ -->
        
        ---
        
        **ä½œæˆæ—¥**: {{today}}  
        **æœ€çµ‚æ›´æ–°**: {{today}}  
        **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: new
    
    # ========================================
    # Phase 5: å®Œäº†é€šçŸ¥
    # ========================================
    - name: "notify_completion"
      action: "notify"
      message: |
        âœ… ãƒã‚°ãƒã‚±ãƒƒãƒˆ {{bug_id}} ã‚’ä½œæˆã—ã¾ã—ãŸ
        
        ğŸ“ ä½œæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«:
        - YAML: bug_tracking/bugs.yaml
        - ãƒ¬ãƒãƒ¼ãƒˆ: bug_tracking/bug_reports/{{bug_id}}.md
        
        ğŸ“ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—:
        1. ãƒ¬ãƒãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã„ã¦è©³ç´°ã‚’ç¢ºèªãƒ»ç·¨é›†
        2. ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆãƒ»ãƒ­ã‚°ã‚’æ·»ä»˜
        3. `/aipm/4_delivery/14_ãƒã‚°ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ` ã§ã‚µãƒãƒªãƒ¼ç¢ºèª
        
        ğŸ”§ ãƒã‚°ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°:
        `/aipm/4_delivery/13_ãƒã‚°ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°`
```

## æˆæœç‰©
- `bug_tracking/bugs.yaml` - ãƒã‚°ã‚¨ãƒ³ãƒˆãƒªè¿½åŠ 
- `bug_tracking/bug_reports/{{BUG_ID}}.md` - å€‹åˆ¥ãƒã‚°ãƒ¬ãƒãƒ¼ãƒˆ

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
- ãƒã‚°ãƒ¬ãƒãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ã¦è©³ç´°ã‚’è¿½è¨˜
- `/aipm/4_delivery/13_ãƒã‚°ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°` ã§ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†
- `/aipm/4_delivery/14_ãƒã‚°ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ` ã§æ—¥æ¬¡ã‚µãƒãƒªãƒ¼ç¢ºèª






















