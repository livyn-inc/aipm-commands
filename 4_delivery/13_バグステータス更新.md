---
name: ãƒã‚°ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°ï¼ˆãƒã‚°ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†ï¼‰
---

# 13 : ãƒã‚°ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–° - ãƒã‚°ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†

## å‰æ
- ãƒã‚°ç™»éŒ²ï¼ˆ12_ãƒã‚°ç™»éŒ²ï¼‰ã§ãƒã‚°ãŒç™»éŒ²æ¸ˆã¿
- bug_tracking/bugs.yaml ã«ãƒã‚°ã‚¨ãƒ³ãƒˆãƒªãŒå­˜åœ¨

## ç›®çš„
- ãƒã‚°ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã«æ²¿ã£ã¦æ›´æ–°
- ä¿®æ­£é€²æ—ã®è¿½è·¡ã¨ã‚³ãƒ¡ãƒ³ãƒˆè¨˜éŒ²
- æ‹…å½“è€…ãƒ»ä¿®æ­£ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ç®¡ç†
- ãƒªãƒªãƒ¼ã‚¹åˆ¤å®šã®ãŸã‚ã®çŠ¶æ…‹ç®¡ç†

## ãƒã‚°ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«
```
New â†’ Open â†’ In Progress â†’ Fixed â†’ Verified â†’ Closed
                                              â†“
                                          Won't Fix
```

## å®Ÿè¡Œæ‰‹é †
```yaml
- trigger: "(ãƒã‚°ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°|Bug Status|ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´|ãƒã‚°æ›´æ–°)"
  priority: high
  steps:
    # ========================================
    # Phase 1: bugs.yamlèª­ã¿è¾¼ã¿ãƒ»ãƒã‚°ä¸€è¦§è¡¨ç¤º
    # ========================================
    - name: "load_bugs"
      action: "read_file"
      file: "Stock/programs/Tools/projects/cursor_to_notion/documents/11_QAå®Ÿè¡Œ/bug_tracking/bugs.yaml"
      store_as: "bugs_data"
    
    - name: "display_bug_list"
      action: "display"
      content: |
        ğŸ“‹ ç™»éŒ²æ¸ˆã¿ãƒã‚°ä¸€è¦§:
        
        {{#each bugs_data.bugs}}
        {{status_icon(this.status)}} {{this.id}}: {{this.title}} ({{this.status}}, {{this.severity}})
        {{/each}}
    
    # ========================================
    # Phase 2: æ›´æ–°å¯¾è±¡ãƒã‚°é¸æŠ
    # ========================================
    - name: "select_bug"
      action: "ask_question"
      question: "æ›´æ–°ã™ã‚‹ãƒã‚°IDã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆä¾‹: BUG-001ï¼‰:"
      required: true
      store_as: "target_bug_id"
    
    - name: "find_bug"
      action: "filter_array"
      array: "{{bugs_data.bugs}}"
      condition: "id == {{target_bug_id}}"
      store_as: "target_bug"
    
    - name: "display_current_status"
      action: "display"
      content: |
        ğŸ” {{target_bug.id}}: {{target_bug.title}}
        
        ç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: {{target_bug.status}}
        æ·±åˆ»åº¦: {{target_bug.severity}}
        å„ªå…ˆåº¦: {{target_bug.priority}}
        ç™ºè¦‹æ—¥: {{target_bug.found_date}}
        ç™ºè¦‹ãƒ†ã‚¹ãƒˆ: {{target_bug.found_in_test}}
        æ‹…å½“è€…: {{target_bug.assignee || "æœªã‚¢ã‚µã‚¤ãƒ³"}}
    
    # ========================================
    # Phase 3: æ–°ã—ã„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å…¥åŠ›
    # ========================================
    - name: "input_new_status"
      action: "ask_questions"
      questions:
        - key: "new_status"
          question: |
            æ–°ã—ã„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’é¸æŠã—ã¦ãã ã•ã„:
            1) new - æ–°è¦ç™»éŒ²
            2) open - ãƒˆãƒªã‚¢ãƒ¼ã‚¸å®Œäº†
            3) in_progress - ä¿®æ­£ä½œæ¥­ä¸­
            4) fixed - ä¿®æ­£å®Œäº†ï¼ˆQAæ¤œè¨¼å¾…ã¡ï¼‰
            5) verified - QAæ¤œè¨¼å®Œäº†ï¼ˆãƒªãƒªãƒ¼ã‚¹å¾…ã¡ï¼‰
            6) closed - ãƒªãƒªãƒ¼ã‚¹å®Œäº†
            7) wont_fix - ä¿®æ­£ã—ãªã„åˆ¤æ–­
          options: ["new", "open", "in_progress", "fixed", "verified", "closed", "wont_fix"]
          required: true
        
        - key: "comment"
          question: "ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆçŠ¶æ³èª¬æ˜ã€ä¿®æ­£å†…å®¹ç­‰ï¼‰:"
          required: false
        
        - key: "assignee"
          question: "æ‹…å½“è€…ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆin_progress/fixedã®å ´åˆï¼‰:"
          required: false
          condition: "{{new_status}} == 'in_progress' || {{new_status}} == 'fixed'"
        
        - key: "fix_version"
          question: "ä¿®æ­£äºˆå®šãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆä¾‹: v1.0.1ï¼‰:"
          required: false
          condition: "{{new_status}} == 'fixed'"
        
        - key: "fix_commit"
          question: "ä¿®æ­£ã‚³ãƒŸãƒƒãƒˆãƒãƒƒã‚·ãƒ¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆfixedã®å ´åˆï¼‰:"
          required: false
          condition: "{{new_status}} == 'fixed'"
      
      store_as: "update_info"
    
    # ========================================
    # Phase 4: bugs.yamlæ›´æ–°
    # ========================================
    - name: "update_bugs_yaml"
      action: "execute_python"
      script: |
        import yaml
        from datetime import datetime
        from pathlib import Path
        
        bugs_yaml = Path("Stock/programs/Tools/projects/cursor_to_notion/documents/11_QAå®Ÿè¡Œ/bug_tracking/bugs.yaml")
        
        # ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
        with open(bugs_yaml, 'r') as f:
            data = yaml.safe_load(f)
        
        # ãƒã‚°ã‚’æ¤œç´¢ã—ã¦æ›´æ–°
        for bug in data['bugs']:
            if bug['id'] == "{{target_bug_id}}":
                bug['status'] = "{{update_info.new_status}}"
                
                # ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ 
                if "{{update_info.comment}}":
                    if 'comments' not in bug:
                        bug['comments'] = []
                    
                    bug['comments'].append({
                        'date': datetime.now().isoformat(),
                        'author': 'QA Engineer',
                        'comment': "{{update_info.comment}}"
                    })
                
                # æ‹…å½“è€…è¨­å®š
                if "{{update_info.assignee}}":
                    bug['assignee'] = "{{update_info.assignee}}"
                
                # fixedã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®å ´åˆ
                if "{{update_info.new_status}}" == "fixed":
                    if not bug.get('fix_date'):
                        bug['fix_date'] = datetime.now().strftime('%Y-%m-%d')
                    if "{{update_info.fix_version}}":
                        bug['fix_version'] = "{{update_info.fix_version}}"
                    if "{{update_info.fix_commit}}":
                        bug['fix_commit'] = "{{update_info.fix_commit}}"
                
                break
        
        # ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æ›´æ–°
        data['metadata']['last_updated'] = datetime.now().isoformat()
        data['metadata']['open_bugs'] = sum(
            1 for b in data['bugs'] 
            if b['status'] in ['new', 'open', 'in_progress']
        )
        data['metadata']['fixed_bugs'] = sum(
            1 for b in data['bugs'] 
            if b['status'] in ['fixed', 'verified']
        )
        data['metadata']['closed_bugs'] = sum(
            1 for b in data['bugs'] 
            if b['status'] == 'closed'
        )
        
        # ä¿å­˜
        with open(bugs_yaml, 'w') as f:
            yaml.dump(data, f, allow_unicode=True, default_flow_style=False, sort_keys=False)
        
        print(f"âœ… {bug['id']} ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ {bug['status']} ã«æ›´æ–°ã—ã¾ã—ãŸ")
    
    # ========================================
    # Phase 5: å®Œäº†é€šçŸ¥
    # ========================================
    - name: "notify_completion"
      action: "notify"
      message: |
        âœ… ãƒã‚°ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°å®Œäº†
        
        ãƒã‚°ID: {{target_bug_id}}
        æ–°ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: {{update_info.new_status}}
        
        ğŸ“Š ç¾åœ¨ã®çµ±è¨ˆ:
        - Open: {{metadata.open_bugs}}
        - Fixed/Verified: {{metadata.fixed_bugs}}
        - Closed: {{metadata.closed_bugs}}
        
        ğŸ“ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—:
        - `/aipm/4_delivery/14_ãƒã‚°ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ` ã§ã‚µãƒãƒªãƒ¼ç¢ºèª
        - fixedã®å ´åˆ: ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆè¿½åŠ ã‚’æ¤œè¨
        - verifiedã®å ´åˆ: ãƒªãƒªãƒ¼ã‚¹åˆ¤å®šã«é€²ã‚€
```

## æˆæœç‰©
- `bug_tracking/bugs.yaml` - ãƒã‚°ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
- `bug_tracking/bug_reports/{{BUG_ID}}.md` - ãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•æ›´æ–°ï¼ˆæ¨å¥¨ï¼‰

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
- fixedã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®å ´åˆ: ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆè¿½åŠ 
- verifiedã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®å ´åˆ: `/aipm/4_delivery/15_ãƒªãƒªãƒ¼ã‚¹åˆ¤å®š`
- `/aipm/4_delivery/14_ãƒã‚°ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ` ã§å…¨ä½“çŠ¶æ³ç¢ºèª






















